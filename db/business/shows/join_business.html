
<div class = "content">

    <div id = "business_summary">

        <h2 id="_id">{{ _id }}</h2>

        <h4 id="author">Created by <a href="/business/{{bid}}/member/{{author}}">{{ author }}</a></h3>

        <h4 id="list_of_partners">Partners: 
                {{#list_of_partners}}
                    <a href="/business/{{bid}}/member/{{value}}">{{value}}</a>,&nbsp
                {{/list_of_partners}}
        </h4>

        <h4 id="description">{{ description }}</h4> 

    </div>

    <div id = "member_info">

        <p>Your initial information is summarized below:</p>

        <form id="member_form" onsubmit="return false;" action="/api/business/{{bid}}/member/{{_id}}">
		    <fieldset class="member_info">
			    <legend>Member Information</legend>
				    <ul>
                        <li><label for="role">Role</label><input type="text" name="role" id="role" value = "worker" readonly/></li>
                        <li><label for="network">Network</label><input type="text" name="network" id="network" value = "Facebook" readonly/></li>
                        <li><label for="type">Type</label><input type="text" name="type" id="type" value = "person" readonly/></li>
                    </ul>
		    </fieldset>

            <fieldset class="member_skills">
			    <legend>Member Skills</legend>
				    <ul>
                    {{#activity_skills}}
                    <li>
                        <label for="{{value}}">{{value}}</label>
                        <input type="checkbox" name="skills" id="{{value}}" value = "{{value}}" />
                    </li>
                    {{/activity_skills}}
                    </ul>
            </fieldset>
        </form>
    </div>

    <button id="join_business">Join {{_id}}</button>
 


    <script type="text/javascript">
    $(document).ready(function() {
        $("#join_business").click(function(){
            join_business();
        });
    });
    
    function join_business(){
        var skills = $("input[name='skills']").serializeArray(); 
        var member = Object();
        var form;

        
        if (skills.length == 0){
            warn("You must check at least on of the Member Skills listed below!");
        } else {
            form = $("#member_form").serializeArray();
            $.each(form, function (item) {
                member[form[item].name] = form[item].value;
            });

            member.skills = [];

            $.each(skills, function (item) {
                member.skills.push(skills[item].value);
            });
        }

        LOG(member.skills);
            
    }

    function build_user_form(){
        var html = '';
        if (get_user() != null){
            html =  '<li><label for="_id">Member ID</label><input type="text" name="_id" id="_id" value = "' + user.id + '"readonly/></li>' +
                    '<li><label for="name">Name</label><input type="text" name="name" id="name" value = "' + user.name + '"readonly/></li>' +
               
            $('#member_form ul').prepend(html);

        }
    }

    function SFOnLoad(){
        build_user_form();
    }
    </script>
</div> 

